package net.fp.algorithms.common.basic;

import net.fp.algorithms.common.matrix.ArrayMatrix;
import net.fp.algorithms.common.matrix.Matrix;

public class MiningApplication {

    public static void main(String[] args) {

        ArrayMatrix ill = new ArrayMatrix(new double[][]{
                {159, 54, 104, 142, 36.7, 78, 6, 8, 89, 88, 80, 62, 290, 40},
                {178, 78, 103, 142, 36.6, 79, 7, 9, 91, 96, 85, 61, 222, 44},
                {177, 72, 105, 144, 36.8, 80, 8, 10, 95, 101, 120, 60, 160, 48},
                {181, 79, 110, 152, 36.7, 81, 8, 10, 97, 99, 125, 62, 300, 40},
                {164, 63, 110, 151, 36.5, 81, 7, 9, 94, 98, 97, 61, 200, 45},
                {190, 93, 95, 138, 36.7, 80, 6, 11, 97, 89, 89, 60, 150, 49},
                {187, 89, 112, 156, 36.7, 82, 8, 12, 87, 93, 170, 58, 288, 39},
                {179, 79, 111, 154, 37.0, 81, 7, 9, 91, 92, 80, 64, 160, 44},
                {182, 81, 94, 141, 37.1, 80, 8, 8, 90, 94, 180, 64, 225, 48},
                {172, 73, 97, 145, 36.9, 75, 8, 7, 98, 96, 130, 62, 232, 39},
                {176, 75, 98, 147, 36.6, 76, 9, 10, 88, 92, 170, 58, 152, 45},
                {178, 80, 105, 150, 36.8, 75, 9, 11, 94, 94, 80, 59, 270, 49},
                {182, 84, 103, 148, 36.8, 76, 10, 10, 121, 92, 125, 65, 212, 39},
                {188, 93, 106, 150, 36.7, 80, 9, 11, 110, 93, 89, 67, 168, 44},
                {165, 70, 104, 148, 36.9, 75, 8, 8, 93, 95, 170, 62, 272, 49},
                {172, 74, 98, 146, 37.0, 77, 7, 9, 83, 96, 154, 67, 218, 40},
                {183, 85, 93, 143, 36.9, 73, 6, 12, 85, 97, 82, 67, 156, 45},
                {180, 82, 92, 141, 36.6, 72, 9, 10, 111, 91, 168, 63, 286, 48},
                {168, 76, 94, 142, 36.7, 74, 8, 8, 92, 92, 126, 67, 216, 39},
                {164, 67, 98, 147, 36.8, 73, 9, 9, 97, 93, 134, 62, 160, 45},
                {189, 94, 90, 139, 36.8, 72, 8, 9, 85, 94, 168, 68, 276, 48},
                {194, 100, 90, 138, 36.8, 73, 7, 7, 87, 95, 112, 63, 228, 46},
                {168, 70, 95, 147, 36.7, 78, 9, 10, 94, 95, 172, 62, 164, 41},
                {170, 72, 100, 151, 36.7, 80, 10, 8, 96, 98, 110, 63, 296, 42},
                {178, 80, 97, 144, 36.7, 79, 6, 9, 102, 99, 146, 62, 152, 39},
                {189, 93, 90, 140, 36.9, 72, 7, 7, 99, 97, 100, 63, 242, 44},
                {162, 65, 108, 155, 36.9, 81, 8, 8, 91, 96, 168, 64, 300, 49},
                {162, 67, 109, 156, 36.7, 82, 8, 9, 90, 95, 120, 65, 168, 39},

        });

        ArrayMatrix notIll = new ArrayMatrix(new double[][]{
                {190, 98, 80, 120, 36.6, 72, 5, 2, 72, 91, 84, 58, 225, 39},
                {178, 82, 90, 132, 36.7, 74, 6, 3, 91, 92, 170, 62, 150, 45},
                {194, 84, 82, 124, 36.8, 71, 6, 4, 89, 92, 140, 47, 300, 49},
                {178, 74, 82, 126, 36.6, 70, 5, 6, 72, 93, 132, 49, 235, 40},
                {168, 67, 80, 121, 36.5, 72, 6, 7, 67, 99, 110, 54, 160, 44},
                {172, 70, 84, 132, 36.8, 69, 5, 5, 92, 91, 90, 56, 290, 48},
                {180, 78, 90, 138, 36.9, 72, 6, 5, 90, 89, 156, 62, 215, 39},
                {179, 72, 92, 138, 36.6, 73, 7, 6, 81, 90, 88, 56, 170, 44},
                {164, 67, 94, 140, 36.7, 72, 4, 4, 82, 87, 90, 54, 289, 48},
                {163, 57, 81, 122, 36.7, 71, 4, 3, 76, 98, 120, 62, 220, 40},
                {177, 67, 82, 122, 36.7, 70, 5, 7, 78, 89, 160, 60, 156, 45},
                {182, 83, 90, 130, 36.7, 72, 6, 5, 67, 90, 98, 48, 283, 49},
                {179, 84, 80, 121, 36.6, 71, 7, 7, 56, 92, 120, 52, 218, 40},
                {185, 83, 79, 122, 36.8, 70, 6, 8, 59, 91, 164, 61, 168, 44},
                {190, 94, 91, 136, 36.8, 69, 5, 9, 90, 95, 110, 48, 296, 49},
                {185, 87, 81, 121, 36.9, 73, 5, 10, 80, 96, 142, 49, 232, 40},
                {189, 91, 84, 123, 36.5, 74, 4, 7, 76, 97, 158, 50, 152, 44},
                {162, 56, 83, 124, 36.6, 72, 6, 8, 69, 98, 134, 54, 274, 48},
                {164, 58, 85, 125, 36.7, 71, 7, 6, 59, 95, 98, 52, 200, 39},
                {158, 52, 80, 120, 36.8, 71, 5, 7, 91, 96, 120, 53, 154, 45},
                {196, 79, 86, 127, 36.7, 72, 4, 8, 73, 96, 110, 55, 300, 49},
                {175, 73, 85, 126, 36.6, 73, 5, 9, 78, 90, 145, 56, 220, 40},
                {164, 59, 81, 121, 36.7, 72, 4, 2, 87, 93, 165, 57, 160, 44},
                {189, 93, 80, 120, 36.8, 71, 5, 3, 59, 92, 170, 58, 288, 49},
                {187, 82, 82, 122, 36.9, 72, 4, 4, 58, 93, 88, 53, 154, 39},
                {191, 95, 89, 130, 37.0, 73, 5, 5, 62, 94, 90, 54, 230, 45}
        });
        byCorrelation(notIll, false);
        System.out.println(notIll);
    }

    public static void byCorrelation(Matrix m, boolean saveNegatives) {
        double totalSum = 0;

        // Generate the total value in each row and column.
        double[] rowSums = new double[m.rows()];
        double[] colSums = new double[m.columns()];
        for (int i = 0; i < m.rows(); ++i) {
            for (int j = 0; j < m.columns(); ++j) {
                totalSum += m.get(i, j);
                colSums[j] += m.get(i, j);
                rowSums[i] += m.get(i, j);
            }
        }

        // Use the row and column totals to compute the correlation.
        for (int i = 0; i < m.rows(); ++i) {
            for (int j = 0; j < m.columns(); ++j) {
                double newVal =
                        (totalSum * m.get(i, j) - rowSums[i] * colSums[j]) /
                                Math.sqrt(rowSums[i] * (totalSum - rowSums[i]) *
                                        colSums[j] * (totalSum - colSums[j]));

                // Store the computed value.
                if (saveNegatives)
                    m.set(i, j, newVal);
                else
                    m.set(i, j, newVal > 0 ? newVal : 0);
            }
        }
    }
}
